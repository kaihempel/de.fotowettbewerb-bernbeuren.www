import{c as P,j as t,a as A,r as M,H as Z}from"./app-CxVVMSuF.js";import{I as T,t as F,b as I,i as B,j as K,G as O}from"./global-layout-DQ8RL7R-.js";import{c as z}from"./utils-D0Zg16Wk.js";import{C as J,a as Q}from"./chevron-right-DQBm3_bi.js";import{c as D}from"./createLucideIcon-DeJudOTN.js";/* empty css            *//**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],X=D("star",W);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],te=D("thumbs-down",ee);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],le=D("thumbs-up",se);function ae(x){const e=P.c(7),{previousPhoto:s,nextPhoto:a}=x,l=re;let r;e[0]!==s?(r=s&&t.jsx(T,{variant:"secondary",onClick:()=>l(s.id),className:z("fixed left-4 top-1/2 z-10 size-12 -translate-y-1/2 rounded-full bg-background/80 shadow-lg backdrop-blur-sm transition-all hover:scale-110 hover:bg-background/90 dark:bg-background/90 dark:hover:bg-background md:left-6 md:size-14"),"aria-label":"Previous photo",children:t.jsx(J,{className:"size-6 md:size-7"})}),e[0]=s,e[1]=r):r=e[1];let o;e[2]!==a?(o=a&&t.jsx(T,{variant:"secondary",onClick:()=>l(a.id),className:z("fixed right-4 top-1/2 z-10 size-12 -translate-y-1/2 rounded-full bg-background/80 shadow-lg backdrop-blur-sm transition-all hover:scale-110 hover:bg-background/90 dark:bg-background/90 dark:hover:bg-background md:right-6 md:size-14"),"aria-label":"Next photo",children:t.jsx(Q,{className:"size-6 md:size-7"})}),e[2]=a,e[3]=o):o=e[3];let i;return e[4]!==r||e[5]!==o?(i=t.jsxs(t.Fragment,{children:[r,o]}),e[4]=r,e[5]=o,e[6]=i):i=e[6],i}function re(x){A.visit(`/gallery/${x}`,{preserveScroll:!1})}function oe(x){const e=P.c(20),{imageUrl:s,title:a,rate:l}=x,r=a||"Contest photo";let o;e[0]!==s||e[1]!==r?(o=t.jsx("div",{className:"relative w-full overflow-hidden rounded-lg bg-muted shadow-xl",children:t.jsx("img",{src:s,alt:r,className:"h-auto w-full max-h-[calc(100vh-20rem)] object-contain md:max-h-[calc(100vh-13rem)]",loading:"eager"})}),e[0]=s,e[1]=r,e[2]=o):o=e[2];let i;e[3]!==a?(i=a&&t.jsx("h2",{className:"text-lg font-semibold text-foreground md:text-xl",children:a}),e[3]=a,e[4]=i):i=e[4];const g=l>0?"fill-yellow-400 text-yellow-400 dark:fill-yellow-500 dark:text-yellow-500":"text-muted-foreground";let m;e[5]!==g?(m=z("size-5",g),e[5]=g,e[6]=m):m=e[6];let n;e[7]!==m?(n=t.jsx(X,{className:m}),e[7]=m,e[8]=n):n=e[8];let d;e[9]!==l?(d=t.jsxs("span",{className:"text-sm font-medium text-foreground",children:["Rating: ",l]}),e[9]=l,e[10]=d):d=e[10];let u;e[11]!==n||e[12]!==d?(u=t.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-muted px-4 py-2",children:[n,d]}),e[11]=n,e[12]=d,e[13]=u):u=e[13];let c;e[14]!==i||e[15]!==u?(c=t.jsxs("div",{className:"flex w-full flex-col items-center gap-2 text-center",children:[i,u]}),e[14]=i,e[15]=u,e[16]=c):c=e[16];let f;return e[17]!==o||e[18]!==c?(f=t.jsxs("div",{className:"flex w-full max-w-6xl flex-col items-center gap-4",children:[o,c]}),e[17]=o,e[18]=c,e[19]=f):f=e[19],f}function ie(x){const e=P.c(35),{currentVote:s,onVote:a,isSubmitting:l}=x,r=s==="down"?"danger":"secondary";let o;e[0]!==a?(o=()=>a("down"),e[0]=a,e[1]=o):o=e[1];const i=s==="down"&&"bg-red-600 text-white hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800",g=s!=="down"&&"border-2 hover:border-red-600 hover:bg-red-50 dark:hover:border-red-700 dark:hover:bg-red-950/30";let m;e[2]!==i||e[3]!==g?(m=z("min-h-[44px] min-w-[44px] gap-3 px-6 py-3 text-base transition-all md:min-h-[48px] md:min-w-[48px] md:px-8 md:py-4 md:text-lg",i,g),e[2]=i,e[3]=g,e[4]=m):m=e[4];const n=s==="down";let d;e[5]!==s||e[6]!==l?(d=l&&s==="down"?t.jsx(F,{className:"size-5 md:size-6"}):t.jsx(te,{className:z("size-5 md:size-6",s==="down"&&"fill-current")}),e[5]=s,e[6]=l,e[7]=d):d=e[7];let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx("span",{className:"font-semibold",children:"Thumbs Down"}),e[8]=u):u=e[8];let c;e[9]!==l||e[10]!==r||e[11]!==o||e[12]!==m||e[13]!==n||e[14]!==d?(c=t.jsxs(T,{variant:r,onClick:o,disabled:l,className:m,"aria-label":"Vote thumbs down","aria-pressed":n,children:[d,u]}),e[9]=l,e[10]=r,e[11]=o,e[12]=m,e[13]=n,e[14]=d,e[15]=c):c=e[15];const f=s==="up"?"primary":"secondary";let p;e[16]!==a?(p=()=>a("up"),e[16]=a,e[17]=p):p=e[17];const w=s==="up"&&"bg-green-600 text-white hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800",j=s!=="up"&&"border-2 hover:border-green-600 hover:bg-green-50 dark:hover:border-green-700 dark:hover:bg-green-950/30";let k;e[18]!==w||e[19]!==j?(k=z("min-h-[44px] min-w-[44px] gap-3 px-6 py-3 text-base transition-all md:min-h-[48px] md:min-w-[48px] md:px-8 md:py-4 md:text-lg",w,j),e[18]=w,e[19]=j,e[20]=k):k=e[20];const N=s==="up";let b;e[21]!==s||e[22]!==l?(b=l&&s==="up"?t.jsx(F,{className:"size-5 md:size-6"}):t.jsx(le,{className:z("size-5 md:size-6",s==="up"&&"fill-current")}),e[21]=s,e[22]=l,e[23]=b):b=e[23];let v;e[24]===Symbol.for("react.memo_cache_sentinel")?(v=t.jsx("span",{className:"font-semibold",children:"Thumbs Up"}),e[24]=v):v=e[24];let h;e[25]!==l||e[26]!==f||e[27]!==p||e[28]!==k||e[29]!==N||e[30]!==b?(h=t.jsxs(T,{variant:f,onClick:p,disabled:l,className:k,"aria-label":"Vote thumbs up","aria-pressed":N,children:[b,v]}),e[25]=l,e[26]=f,e[27]=p,e[28]=k,e[29]=N,e[30]=b,e[31]=h):h=e[31];let y;return e[32]!==h||e[33]!==c?(y=t.jsxs("div",{className:"flex items-center justify-center gap-4 md:gap-6",children:[c,h]}),e[32]=h,e[33]=c,e[34]=y):y=e[34],y}function ne(x){const e=P.c(40),{photo:s,nextPhoto:a,previousPhoto:l,progress:r}=x,[o,i]=M.useState(null),[g,m]=M.useState(!1),[n,d]=M.useState(null),[u,c]=M.useState(0),f=o!==null?o:s.user_vote;let p,w;e[0]!==a||e[1]!==l?(p=()=>{const $=E=>{E.target instanceof HTMLInputElement||E.target instanceof HTMLTextAreaElement||(E.key==="ArrowLeft"&&l?A.visit(`/gallery/${l.id}`,{preserveScroll:!1}):E.key==="ArrowRight"&&a&&A.visit(`/gallery/${a.id}`,{preserveScroll:!1}))};return window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)},w=[a,l],e[0]=a,e[1]=l,e[2]=p,e[3]=w):(p=e[2],w=e[3]),M.useEffect(p,w);let j;e[4]!==f||e[5]!==s.id?(j=$=>{if(f===$)return;const E=f;i($),m(!0),d(null);const G=U=>{const H=U===void 0?0:U;A.post(`/gallery/${s.id}/vote`,{vote_type:$},{preserveScroll:!0,onError:q=>{if(H<3){const Y=Math.pow(2,H)*500;setTimeout(()=>{G(H+1)},Y),c(H+1)}else i(E),d(q.vote_type||"Failed to submit vote after multiple attempts. Please try again."),c(0)},onSuccess:()=>{c(0),d(null)},onFinish:()=>{m(!1)}})};G()},e[4]=f,e[5]=s.id,e[6]=j):j=e[6];const k=j,N=r.rated===r.total;let b;e[7]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsx(Z,{title:"Photo Voting Gallery"}),e[7]=b):b=e[7];let v;e[8]!==n?(v=n&&t.jsx("div",{className:"fixed left-1/2 top-4 z-10 w-full max-w-md -translate-x-1/2",children:t.jsxs(I,{type:"default",children:[t.jsx(I.Icon,{path:B,iconClass:"text-orange-400",iconDivClass:"bg-orange-500/20"}),t.jsx("span",{children:n})]})}),e[8]=n,e[9]=v):v=e[9];let h;e[10]!==u?(h=u>0&&t.jsx("div",{className:"fixed left-1/2 top-4 z-10 -translate-x-1/2",children:t.jsxs("div",{className:"rounded-lg bg-yellow-100 px-4 py-2 text-sm text-yellow-900 dark:bg-yellow-900/20 dark:text-yellow-100",children:["Retrying... (Attempt ",u,"/3)"]})}),e[10]=u,e[11]=h):h=e[11];let y;e[12]!==n||e[13]!==N||e[14]!==r.total?(y=N&&!n&&t.jsx("div",{className:"fixed left-1/2 top-4 z-10 w-full max-w-md -translate-x-1/2",children:t.jsxs(I,{type:"default",children:[t.jsx(I.Icon,{path:K,iconClass:"text-orange-400",iconDivClass:"bg-orange-500/20"}),t.jsxs("span",{children:["You have rated all ",r.total," photos. You can still navigate and change your votes."]})]})}),e[12]=n,e[13]=N,e[14]=r.total,e[15]=y):y=e[15];let _;e[16]!==r.rated||e[17]!==r.total?(_=t.jsx("div",{className:"rounded-lg bg-background/80 px-4 py-2 shadow-lg backdrop-blur-sm dark:bg-background/90",children:t.jsxs("p",{className:"text-sm font-medium text-muted-foreground",children:[r.rated," of ",r.total," photos rated"]})}),e[16]=r.rated,e[17]=r.total,e[18]=_):_=e[18];let C;e[19]!==s.full_image_url||e[20]!==s.rate||e[21]!==s.title?(C=t.jsx(oe,{imageUrl:s.full_image_url,title:s.title,rate:s.rate}),e[19]=s.full_image_url,e[20]=s.rate,e[21]=s.title,e[22]=C):C=e[22];let S;e[23]!==_||e[24]!==C?(S=t.jsxs("div",{className:"flex flex-1 flex-col items-center gap-6 p-4 pt-8 md:p-6 md:pt-12",children:[_,C]}),e[23]=_,e[24]=C,e[25]=S):S=e[25];let V;e[26]!==f||e[27]!==k||e[28]!==g?(V=t.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-background/80 p-4 backdrop-blur-sm dark:bg-background/90 md:p-6",children:t.jsx("div",{className:"mx-auto max-w-2xl",children:t.jsx(ie,{currentVote:f,onVote:k,isSubmitting:g})})}),e[26]=f,e[27]=k,e[28]=g,e[29]=V):V=e[29];let L;e[30]!==a||e[31]!==l?(L=t.jsx(ae,{previousPhoto:l,nextPhoto:a}),e[30]=a,e[31]=l,e[32]=L):L=e[32];let R;return e[33]!==S||e[34]!==V||e[35]!==L||e[36]!==v||e[37]!==h||e[38]!==y?(R=t.jsxs(O,{className:"p-0",children:[b,t.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[v,h,y,S,V,L]})]}),e[33]=S,e[34]=V,e[35]=L,e[36]=v,e[37]=h,e[38]=y,e[39]=R):R=e[39],R}function he(x){const e=P.c(2);let s;return e[0]!==x?(s=t.jsx(ne,{...x},x.photo.id),e[0]=x,e[1]=s):s=e[1],s}export{he as default};
