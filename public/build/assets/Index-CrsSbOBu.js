import{c as k,r as x,j as t,L as M,a as P,H as E}from"./app-CRSaV7fU.js";import{F as C}from"./ui-C-FlF6Nz-BzxikYqa.js";/* empty css            */const F=s=>{const e=k.c(12),{photo:o,votingUrl:l}=s,[n,i]=x.useState(!1),[m,c]=x.useState(!1);let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u=()=>{i(!0)},e[0]=u):u=e[0];const r=u;let f;e[1]===Symbol.for("react.memo_cache_sentinel")?(f=()=>{c(!0),i(!0)},e[1]=f):f=e[1];const a=f,p=`View and vote on photo ${o.id}`;let h;e[2]!==m||e[3]!==n||e[4]!==o.id||e[5]!==o.rate||e[6]!==o.thumbnail_url?(h=m?t.jsx("div",{className:"flex h-full w-full items-center justify-center bg-muted",children:t.jsxs("div",{className:"text-center",children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-muted-foreground",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"Failed to load image"})]})}):t.jsxs(t.Fragment,{children:[t.jsx("img",{src:o.thumbnail_url,alt:`Photo ${o.id}`,loading:"lazy",onLoad:r,onError:a,className:`h-full w-full object-cover transition-opacity duration-300 ${n?"opacity-100":"opacity-0"}`}),t.jsx("div",{className:"absolute inset-0 bg-black/0 transition-colors duration-200 group-hover:bg-black/10 dark:group-hover:bg-black/30"}),o.rate!==null&&t.jsxs("div",{className:"absolute right-2 top-2 rounded-md bg-black/60 px-2 py-1 text-xs font-medium text-white backdrop-blur-sm",children:[o.rate>0?"+":"",o.rate]})]}),e[2]=m,e[3]=n,e[4]=o.id,e[5]=o.rate,e[6]=o.thumbnail_url,e[7]=h):h=e[7];let d;return e[8]!==p||e[9]!==h||e[10]!==l?(d=t.jsx(M,{href:l,className:"group relative block aspect-square overflow-hidden rounded-lg bg-muted transition-transform duration-200 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 hover:scale-105 hover:shadow-lg",role:"link","aria-label":p,children:h}),e[8]=p,e[9]=h,e[10]=l,e[11]=d):d=e[11],d},H=s=>{const e=k.c(2),{count:o}=s,l=o===void 0?20:o;let n;return e[0]!==l?(n=t.jsx(t.Fragment,{children:Array.from({length:l}).map($)}),e[0]=l,e[1]=n):n=e[1],n};function $(s,e){return t.jsx("div",{className:"aspect-square",role:"status","aria-label":"Loading photo",children:t.jsx(C,{className:"h-full w-full rounded-lg"})},e)}const R=s=>{const e=k.c(13),{initialPhotos:o,initialCursor:l,initialHasMore:n}=s,[i,m]=x.useState(o),[c,u]=x.useState(l),[r,f]=x.useState(n),[a,p]=x.useState(!1),h=x.useRef(null),d=x.useRef(null);let j;e[0]!==c||e[1]!==r||e[2]!==a?(j=()=>{a||!r||!c||(p(!0),P.get("/gallery/list",{cursor:c},{preserveScroll:!0,preserveState:!0,only:["photos","next_cursor","has_more"],onSuccess:b=>{const g=b.props.photos||[],L=b.props.next_cursor||null,w=b.props.has_more||!1;m(S=>[...S,...g]),u(L),f(w)},onError:G,onFinish:()=>{p(!1)}}))},e[0]=c,e[1]=r,e[2]=a,e[3]=j):j=e[3];const v=j;let N,y;e[4]!==r||e[5]!==a||e[6]!==v?(N=()=>{const b={root:null,rootMargin:"100px",threshold:.1};d.current=new IntersectionObserver(L=>{L[0].isIntersecting&&!a&&r&&v()},b);const g=h.current;return g&&d.current&&d.current.observe(g),()=>{d.current&&g&&d.current.unobserve(g),d.current&&d.current.disconnect()}},y=[a,r,v],e[4]=r,e[5]=a,e[6]=v,e[7]=N,e[8]=y):(N=e[7],y=e[8]),x.useEffect(N,y);let _;return e[9]!==r||e[10]!==a||e[11]!==i?(_=t.jsx("div",{className:"w-full",children:i.length===0&&!a?t.jsx("div",{className:"flex min-h-[400px] items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("svg",{className:"mx-auto h-16 w-16 text-muted-foreground",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("h3",{className:"mt-4 text-lg font-medium text-foreground",children:"No photos available yet"}),t.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"No photos available yet. Check back soon!"})]})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5",role:"list","aria-label":"Photo gallery",children:[i.map(I),a&&t.jsx(H,{count:20})]}),t.jsxs("div",{ref:h,className:"mt-8 flex justify-center","aria-live":"polite","aria-atomic":"true",children:[a&&t.jsx("p",{className:"text-sm text-muted-foreground","aria-label":"Loading more photos",children:"Loading more photos..."}),!r&&i.length>0&&t.jsx("p",{className:"text-sm text-muted-foreground",children:"You've reached the end!"})]})]})}),e[9]=r,e[10]=a,e[11]=i,e[12]=_):_=e[12],_};function G(s){console.error("Failed to load more photos:",s)}function I(s){return t.jsx(F,{photo:s,votingUrl:`/gallery/${s.id}`},s.id)}function q(s){const e=k.c(9),{photos:o,next_cursor:l,has_more:n}=s;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=t.jsx(E,{title:"Photo Gallery",children:t.jsx("meta",{name:"description",content:"Browse and vote on photos from our photo contest"})}),e[0]=i):i=e[0];let m;e[1]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx("header",{className:"border-b bg-background",children:t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:px-6 lg:px-8",children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight text-foreground sm:text-4xl",children:"Photo Gallery"}),t.jsx("p",{className:"mt-2 text-sm text-muted-foreground sm:text-base",children:"Browse and vote on your favorite photos"})]})}),e[1]=m):m=e[1];let c;e[2]!==n||e[3]!==l||e[4]!==o?(c=t.jsxs("main",{className:"container mx-auto px-4 py-8 sm:px-6 lg:px-8",children:["TEST",t.jsx(R,{initialPhotos:o,initialCursor:l,initialHasMore:n})]}),e[2]=n,e[3]=l,e[4]=o,e[5]=c):c=e[5];let u;e[6]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx("footer",{className:"mt-16 border-t",children:t.jsx("div",{className:"container mx-auto px-4 py-6 text-center text-sm text-muted-foreground sm:px-6 lg:px-8",children:t.jsx("p",{children:"Photo Contest Gallery"})})}),e[6]=u):u=e[6];let r;return e[7]!==c?(r=t.jsxs(t.Fragment,{children:[i,t.jsxs("div",{className:"min-h-screen bg-background",children:[m,c,u]})]}),e[7]=c,e[8]=r):r=e[8],r}export{q as default};
