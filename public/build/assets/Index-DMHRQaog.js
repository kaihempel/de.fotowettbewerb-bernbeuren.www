import{c as k,r as h,j as t,L as M,a as P,H as E}from"./app-Cw9Gt85D.js";import{F as H,G as $}from"./global-layout-D-ZGwDro.js";/* empty css            */const C=s=>{const e=k.c(12),{photo:o,votingUrl:l}=s,[r,n]=h.useState(!1),[u,d]=h.useState(!1);let x;e[0]===Symbol.for("react.memo_cache_sentinel")?(x=()=>{n(!0)},e[0]=x):x=e[0];const i=x;let f;e[1]===Symbol.for("react.memo_cache_sentinel")?(f=()=>{d(!0),n(!0)},e[1]=f):f=e[1];const a=f,g=`View and vote on photo ${o.id}`;let m;e[2]!==u||e[3]!==r||e[4]!==o.id||e[5]!==o.rate||e[6]!==o.thumbnail_url?(m=u?t.jsx("div",{className:"flex h-full w-full items-center justify-center bg-muted",children:t.jsxs("div",{className:"text-center",children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-muted-foreground",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"Failed to load image"})]})}):t.jsxs(t.Fragment,{children:[t.jsx("img",{src:o.thumbnail_url,alt:`Photo ${o.id}`,loading:"lazy",onLoad:i,onError:a,className:`h-full w-full object-cover transition-opacity duration-300 ${r?"opacity-100":"opacity-0"}`}),t.jsx("div",{className:"absolute inset-0 bg-black/0 transition-colors duration-200 group-hover:bg-black/10 dark:group-hover:bg-black/30"}),o.rate!==null&&t.jsxs("div",{className:"absolute right-2 top-2 rounded-md bg-black/60 px-2 py-1 text-xs font-medium text-white backdrop-blur-sm",children:[o.rate>0?"+":"",o.rate]})]}),e[2]=u,e[3]=r,e[4]=o.id,e[5]=o.rate,e[6]=o.thumbnail_url,e[7]=m):m=e[7];let c;return e[8]!==g||e[9]!==m||e[10]!==l?(c=t.jsx(M,{href:l,className:"group relative block aspect-square overflow-hidden rounded-lg bg-muted transition-transform duration-200 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 hover:scale-105 hover:shadow-lg",role:"link","aria-label":g,children:m}),e[8]=g,e[9]=m,e[10]=l,e[11]=c):c=e[11],c},F=s=>{const e=k.c(2),{count:o}=s,l=o===void 0?20:o;let r;return e[0]!==l?(r=t.jsx(t.Fragment,{children:Array.from({length:l}).map(R)}),e[0]=l,e[1]=r):r=e[1],r};function R(s,e){return t.jsx("div",{className:"aspect-square",role:"status","aria-label":"Loading photo",children:t.jsx(H,{className:"h-full w-full rounded-lg"})},e)}const G=s=>{const e=k.c(13),{initialPhotos:o,initialCursor:l,initialHasMore:r}=s,[n,u]=h.useState(o),[d,x]=h.useState(l),[i,f]=h.useState(r),[a,g]=h.useState(!1),m=h.useRef(null),c=h.useRef(null);let j;e[0]!==d||e[1]!==i||e[2]!==a?(j=()=>{a||!i||!d||(g(!0),P.get("/gallery/list",{cursor:d},{preserveScroll:!0,preserveState:!0,only:["photos","next_cursor","has_more"],onSuccess:v=>{const p=v.props.photos||[],L=v.props.next_cursor||null,w=v.props.has_more||!1;u(S=>[...S,...p]),x(L),f(w)},onError:I,onFinish:()=>{g(!1)}}))},e[0]=d,e[1]=i,e[2]=a,e[3]=j):j=e[3];const b=j;let N,y;e[4]!==i||e[5]!==a||e[6]!==b?(N=()=>{const v={root:null,rootMargin:"100px",threshold:.1};c.current=new IntersectionObserver(L=>{L[0].isIntersecting&&!a&&i&&b()},v);const p=m.current;return p&&c.current&&c.current.observe(p),()=>{c.current&&p&&c.current.unobserve(p),c.current&&c.current.disconnect()}},y=[a,i,b],e[4]=i,e[5]=a,e[6]=b,e[7]=N,e[8]=y):(N=e[7],y=e[8]),h.useEffect(N,y);let _;return e[9]!==i||e[10]!==a||e[11]!==n?(_=t.jsx("div",{className:"w-full",children:n.length===0&&!a?t.jsx("div",{className:"flex min-h-[400px] items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("svg",{className:"mx-auto h-16 w-16 text-muted-foreground",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("h3",{className:"mt-4 text-lg font-medium text-foreground",children:"No photos available yet"}),t.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"No photos available yet. Check back soon!"})]})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5",role:"list","aria-label":"Photo gallery",children:[n.map(B),a&&t.jsx(F,{count:20})]}),t.jsxs("div",{ref:m,className:"mt-8 flex justify-center","aria-live":"polite","aria-atomic":"true",children:[a&&t.jsx("p",{className:"text-sm text-muted-foreground","aria-label":"Loading more photos",children:"Loading more photos..."}),!i&&n.length>0&&t.jsx("p",{className:"text-sm text-muted-foreground",children:"You've reached the end!"})]})]})}),e[9]=i,e[10]=a,e[11]=n,e[12]=_):_=e[12],_};function I(s){console.error("Failed to load more photos:",s)}function B(s){return t.jsx(C,{photo:s,votingUrl:`/gallery/${s.id}`},s.id)}function U(s){const e=k.c(6),{photos:o,next_cursor:l,has_more:r}=s;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=t.jsx(E,{title:"Photo Gallery",children:t.jsx("meta",{name:"description",content:"Browse and vote on photos from our photo contest"})}),e[0]=n):n=e[0];let u;e[1]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsxs("div",{className:"mb-8 text-center",children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight text-foreground sm:text-4xl",children:"Photo Gallery"}),t.jsx("p",{className:"mt-2 text-sm text-muted-foreground sm:text-base",children:"Browse and vote on your favorite photos"})]}),e[1]=u):u=e[1];let d;return e[2]!==r||e[3]!==l||e[4]!==o?(d=t.jsxs($,{children:[n,t.jsxs("div",{className:"mx-auto max-w-7xl",children:[u,t.jsx(G,{initialPhotos:o,initialCursor:l,initialHasMore:r})]})]}),e[2]=r,e[3]=l,e[4]=o,e[5]=d):d=e[5],d}export{U as default};
