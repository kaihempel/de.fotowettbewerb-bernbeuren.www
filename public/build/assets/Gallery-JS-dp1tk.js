import{c as P,j as t,r as H,a as M,H as O}from"./app-BqlnNl0I.js";import{B as D}from"./button-Bqcng_PF.js";import{c as z}from"./utils-D0Zg16Wk.js";import{C as J}from"./chevron-left-B1Ts99TX.js";import{C as Q}from"./chevron-right-3h9ii_82.js";import{c as F}from"./createLucideIcon--_jW3eRG.js";import{S as G}from"./spinner-Kgd3yw-y.js";import{A as I,a as q,b as Y}from"./alert-Dwv7Kbdv.js";import{C as W}from"./circle-check-CFCqEZ_Q.js";/* empty css            */import"./loader-circle-BzqyhZeu.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ee=F("Star",X);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],se=F("ThumbsDown",te);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],re=F("ThumbsUp",le);function ae(f){const e=P.c(7),{previousPhoto:s,nextPhoto:r}=f,l=oe;let a;e[0]!==s?(a=s&&t.jsx(D,{variant:"outline",size:"icon",onClick:()=>l(s.id),className:z("fixed left-4 top-1/2 z-10 size-12 -translate-y-1/2 rounded-full bg-background/80 shadow-lg backdrop-blur-sm transition-all hover:scale-110 hover:bg-background/90 dark:bg-background/90 dark:hover:bg-background md:left-6 md:size-14"),"aria-label":"Previous photo",children:t.jsx(J,{className:"size-6 md:size-7"})}),e[0]=s,e[1]=a):a=e[1];let o;e[2]!==r?(o=r&&t.jsx(D,{variant:"outline",size:"icon",onClick:()=>l(r.id),className:z("fixed right-4 top-1/2 z-10 size-12 -translate-y-1/2 rounded-full bg-background/80 shadow-lg backdrop-blur-sm transition-all hover:scale-110 hover:bg-background/90 dark:bg-background/90 dark:hover:bg-background md:right-6 md:size-14"),"aria-label":"Next photo",children:t.jsx(Q,{className:"size-6 md:size-7"})}),e[2]=r,e[3]=o):o=e[3];let n;return e[4]!==a||e[5]!==o?(n=t.jsxs(t.Fragment,{children:[a,o]}),e[4]=a,e[5]=o,e[6]=n):n=e[6],n}function oe(f){H.visit(`/gallery/${f}`,{preserveScroll:!1})}function ie(f){const e=P.c(20),{imageUrl:s,title:r,rate:l}=f,a=r||"Contest photo";let o;e[0]!==s||e[1]!==a?(o=t.jsx("div",{className:"relative w-full overflow-hidden rounded-lg bg-muted shadow-xl",children:t.jsx("img",{src:s,alt:a,className:"h-auto w-full max-h-[calc(100vh-20rem)] object-contain md:max-h-[calc(100vh-24rem)]",loading:"eager"})}),e[0]=s,e[1]=a,e[2]=o):o=e[2];let n;e[3]!==r?(n=r&&t.jsx("h2",{className:"text-lg font-semibold text-foreground md:text-xl",children:r}),e[3]=r,e[4]=n):n=e[4];const h=l>0?"fill-yellow-400 text-yellow-400 dark:fill-yellow-500 dark:text-yellow-500":"text-muted-foreground";let u;e[5]!==h?(u=z("size-5",h),e[5]=h,e[6]=u):u=e[6];let d;e[7]!==u?(d=t.jsx(ee,{className:u}),e[7]=u,e[8]=d):d=e[8];let c;e[9]!==l?(c=t.jsxs("span",{className:"text-sm font-medium text-foreground",children:["Rating: ",l]}),e[9]=l,e[10]=c):c=e[10];let x;e[11]!==d||e[12]!==c?(x=t.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-muted px-4 py-2",children:[d,c]}),e[11]=d,e[12]=c,e[13]=x):x=e[13];let m;e[14]!==n||e[15]!==x?(m=t.jsxs("div",{className:"flex w-full flex-col items-center gap-2 text-center",children:[n,x]}),e[14]=n,e[15]=x,e[16]=m):m=e[16];let i;return e[17]!==o||e[18]!==m?(i=t.jsxs("div",{className:"flex w-full max-w-6xl flex-col items-center gap-4",children:[o,m]}),e[17]=o,e[18]=m,e[19]=i):i=e[19],i}function ne(f){const e=P.c(35),{currentVote:s,onVote:r,isSubmitting:l}=f,a=s==="down"?"destructive":"outline";let o;e[0]!==r?(o=()=>r("down"),e[0]=r,e[1]=o):o=e[1];const n=s==="down"&&"bg-red-600 text-white hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800",h=s!=="down"&&"border-2 hover:border-red-600 hover:bg-red-50 dark:hover:border-red-700 dark:hover:bg-red-950/30";let u;e[2]!==n||e[3]!==h?(u=z("min-h-[44px] min-w-[44px] gap-3 px-6 py-3 text-base transition-all md:min-h-[48px] md:min-w-[48px] md:px-8 md:py-4 md:text-lg",n,h),e[2]=n,e[3]=h,e[4]=u):u=e[4];const d=s==="down";let c;e[5]!==s||e[6]!==l?(c=l&&s==="down"?t.jsx(G,{className:"size-5 md:size-6"}):t.jsx(se,{className:z("size-5 md:size-6",s==="down"&&"fill-current")}),e[5]=s,e[6]=l,e[7]=c):c=e[7];let x;e[8]===Symbol.for("react.memo_cache_sentinel")?(x=t.jsx("span",{className:"font-semibold",children:"Thumbs Down"}),e[8]=x):x=e[8];let m;e[9]!==l||e[10]!==a||e[11]!==o||e[12]!==u||e[13]!==d||e[14]!==c?(m=t.jsxs(D,{variant:a,size:"lg",onClick:o,disabled:l,className:u,"aria-label":"Vote thumbs down","aria-pressed":d,children:[c,x]}),e[9]=l,e[10]=a,e[11]=o,e[12]=u,e[13]=d,e[14]=c,e[15]=m):m=e[15];const i=s==="up"?"default":"outline";let p;e[16]!==r?(p=()=>r("up"),e[16]=r,e[17]=p):p=e[17];const j=s==="up"&&"bg-green-600 text-white hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800",w=s!=="up"&&"border-2 hover:border-green-600 hover:bg-green-50 dark:hover:border-green-700 dark:hover:bg-green-950/30";let g;e[18]!==j||e[19]!==w?(g=z("min-h-[44px] min-w-[44px] gap-3 px-6 py-3 text-base transition-all md:min-h-[48px] md:min-w-[48px] md:px-8 md:py-4 md:text-lg",j,w),e[18]=j,e[19]=w,e[20]=g):g=e[20];const y=s==="up";let k;e[21]!==s||e[22]!==l?(k=l&&s==="up"?t.jsx(G,{className:"size-5 md:size-6"}):t.jsx(re,{className:z("size-5 md:size-6",s==="up"&&"fill-current")}),e[21]=s,e[22]=l,e[23]=k):k=e[23];let N;e[24]===Symbol.for("react.memo_cache_sentinel")?(N=t.jsx("span",{className:"font-semibold",children:"Thumbs Up"}),e[24]=N):N=e[24];let b;e[25]!==l||e[26]!==i||e[27]!==p||e[28]!==g||e[29]!==y||e[30]!==k?(b=t.jsxs(D,{variant:i,size:"lg",onClick:p,disabled:l,className:g,"aria-label":"Vote thumbs up","aria-pressed":y,children:[k,N]}),e[25]=l,e[26]=i,e[27]=p,e[28]=g,e[29]=y,e[30]=k,e[31]=b):b=e[31];let v;return e[32]!==b||e[33]!==m?(v=t.jsxs("div",{className:"flex items-center justify-center gap-4 md:gap-6",children:[m,b]}),e[32]=b,e[33]=m,e[34]=v):v=e[34],v}function de(f){const e=P.c(42),{photo:s,nextPhoto:r,previousPhoto:l,progress:a}=f,[o,n]=M.useState(null),[h,u]=M.useState(!1),[d,c]=M.useState(null),[x,m]=M.useState(0),i=o!==null?o:s.user_vote;let p,j;e[0]!==r||e[1]!==l?(p=()=>{const A=E=>{E.target instanceof HTMLInputElement||E.target instanceof HTMLTextAreaElement||(E.key==="ArrowLeft"&&l?H.visit(`/gallery/${l.id}`,{preserveScroll:!1}):E.key==="ArrowRight"&&r&&H.visit(`/gallery/${r.id}`,{preserveScroll:!1}))};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},j=[r,l],e[0]=r,e[1]=l,e[2]=p,e[3]=j):(p=e[2],j=e[3]),M.useEffect(p,j);let w;e[4]!==i||e[5]!==s.id?(w=A=>{if(i===A)return;const E=i;n(A),u(!0),c(null);const U=B=>{const T=B===void 0?0:B;H.post(`/gallery/${s.id}/vote`,{vote_type:A},{preserveScroll:!0,onError:Z=>{if(T<3){const K=Math.pow(2,T)*500;setTimeout(()=>{U(T+1)},K),m(T+1)}else n(E),c(Z.vote_type||"Failed to submit vote after multiple attempts. Please try again."),m(0)},onSuccess:()=>{m(0),c(null)},onFinish:()=>{u(!1)}})};U()},e[4]=i,e[5]=s.id,e[6]=w):w=e[6];const g=w;let y;e[7]!==i||e[8]!==g?(y=()=>{i&&g(i)},e[7]=i,e[8]=g,e[9]=y):y=e[9];const k=y,N=a.rated===a.total;let b;e[10]===Symbol.for("react.memo_cache_sentinel")?(b=t.jsx(O,{title:"Photo Voting Gallery"}),e[10]=b):b=e[10];let v;e[11]!==a.rated||e[12]!==a.total?(v=t.jsx("div",{className:"fixed right-4 top-4 z-10 rounded-lg bg-background/80 px-4 py-2 shadow-lg backdrop-blur-sm dark:bg-background/90",children:t.jsxs("p",{className:"text-sm font-medium text-muted-foreground",children:[a.rated," of ",a.total," photos rated"]})}),e[11]=a.rated,e[12]=a.total,e[13]=v):v=e[13];let _;e[14]!==d||e[15]!==k?(_=d&&t.jsx("div",{className:"fixed left-1/2 top-4 z-10 w-full max-w-md -translate-x-1/2",children:t.jsxs(I,{variant:"destructive",children:[t.jsx(q,{children:"Vote Failed"}),t.jsxs(Y,{className:"flex flex-col gap-2",children:[t.jsx("span",{children:d}),t.jsx("button",{onClick:k,className:"text-sm underline hover:no-underline",children:"Retry"})]})]})}),e[14]=d,e[15]=k,e[16]=_):_=e[16];let S;e[17]!==x?(S=x>0&&t.jsx("div",{className:"fixed left-1/2 top-4 z-10 -translate-x-1/2",children:t.jsxs("div",{className:"rounded-lg bg-yellow-100 px-4 py-2 text-sm text-yellow-900 dark:bg-yellow-900/20 dark:text-yellow-100",children:["Retrying... (Attempt ",x,"/3)"]})}),e[17]=x,e[18]=S):S=e[18];let C;e[19]!==d||e[20]!==N||e[21]!==a.total?(C=N&&!d&&t.jsx("div",{className:"fixed left-1/2 top-4 z-10 w-full max-w-md -translate-x-1/2",children:t.jsxs(I,{className:"border-green-200 bg-green-50 dark:border-green-900 dark:bg-green-950",children:[t.jsx(W,{className:"size-4 text-green-600 dark:text-green-400"}),t.jsx(q,{className:"text-green-900 dark:text-green-100",children:"Congratulations!"}),t.jsxs(Y,{className:"text-green-800 dark:text-green-200",children:["You have rated all ",a.total," photos. You can still navigate and change your votes."]})]})}),e[19]=d,e[20]=N,e[21]=a.total,e[22]=C):C=e[22];let V;e[23]!==s.image_url||e[24]!==s.rate||e[25]!==s.title?(V=t.jsx("div",{className:"flex flex-1 flex-col items-center justify-center p-4 pb-32 pt-20 md:p-6 md:pb-40",children:t.jsx(ie,{imageUrl:s.image_url,title:s.title,rate:s.rate})}),e[23]=s.image_url,e[24]=s.rate,e[25]=s.title,e[26]=V):V=e[26];let L;e[27]!==i||e[28]!==g||e[29]!==h?(L=t.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-background/80 p-4 backdrop-blur-sm dark:bg-background/90 md:p-6",children:t.jsx("div",{className:"mx-auto max-w-2xl",children:t.jsx(ne,{currentVote:i,onVote:g,isSubmitting:h})})}),e[27]=i,e[28]=g,e[29]=h,e[30]=L):L=e[30];let $;e[31]!==r||e[32]!==l?($=t.jsx(ae,{previousPhoto:l,nextPhoto:r}),e[31]=r,e[32]=l,e[33]=$):$=e[33];let R;return e[34]!==V||e[35]!==L||e[36]!==$||e[37]!==v||e[38]!==_||e[39]!==S||e[40]!==C?(R=t.jsxs(t.Fragment,{children:[b,t.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[v,_,S,C,V,L,$]})]}),e[34]=V,e[35]=L,e[36]=$,e[37]=v,e[38]=_,e[39]=S,e[40]=C,e[41]=R):R=e[41],R}function je(f){const e=P.c(2);let s;return e[0]!==f?(s=t.jsx(de,{...f},f.photo.id),e[0]=f,e[1]=s):s=e[1],s}export{je as default};
