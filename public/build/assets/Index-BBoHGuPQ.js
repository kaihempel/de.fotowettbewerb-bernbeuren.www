import{c as j,a as x,j as t,L as M,r as P,H as $}from"./app-BAEzccgH.js";import{c as C}from"./utils-D0Zg16Wk.js";/* empty css            */const E=a=>{const e=j.c(12),{photo:s,votingUrl:r}=a,[o,l]=x.useState(!1),[m,c]=x.useState(!1);let u;e[0]===Symbol.for("react.memo_cache_sentinel")?(u=()=>{l(!0)},e[0]=u):u=e[0];const n=u;let f;e[1]===Symbol.for("react.memo_cache_sentinel")?(f=()=>{c(!0),l(!0)},e[1]=f):f=e[1];const i=f,p=`View and vote on photo ${s.id}`;let h;e[2]!==m||e[3]!==o||e[4]!==s.id||e[5]!==s.rate||e[6]!==s.thumbnail_url?(h=m?t.jsx("div",{className:"flex h-full w-full items-center justify-center bg-muted",children:t.jsxs("div",{className:"text-center",children:[t.jsx("svg",{className:"mx-auto h-12 w-12 text-muted-foreground",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:"Failed to load image"})]})}):t.jsxs(t.Fragment,{children:[t.jsx("img",{src:s.thumbnail_url,alt:`Photo ${s.id}`,loading:"lazy",onLoad:n,onError:i,className:`h-full w-full object-cover transition-opacity duration-300 ${o?"opacity-100":"opacity-0"}`}),t.jsx("div",{className:"absolute inset-0 bg-black/0 transition-colors duration-200 group-hover:bg-black/10 dark:group-hover:bg-black/30"}),s.rate!==null&&t.jsxs("div",{className:"absolute right-2 top-2 rounded-md bg-black/60 px-2 py-1 text-xs font-medium text-white backdrop-blur-sm",children:[s.rate>0?"+":"",s.rate]})]}),e[2]=m,e[3]=o,e[4]=s.id,e[5]=s.rate,e[6]=s.thumbnail_url,e[7]=h):h=e[7];let d;return e[8]!==p||e[9]!==h||e[10]!==r?(d=t.jsx(M,{href:r,className:"group relative block aspect-square overflow-hidden rounded-lg bg-muted transition-transform duration-200 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 hover:scale-105 hover:shadow-lg",role:"link","aria-label":p,children:h}),e[8]=p,e[9]=h,e[10]=r,e[11]=d):d=e[11],d};function H(a){const e=j.c(8);let s,r;e[0]!==a?({className:s,...r}=a,e[0]=a,e[1]=s,e[2]=r):(s=e[1],r=e[2]);let o;e[3]!==s?(o=C("bg-primary/10 animate-pulse rounded-md",s),e[3]=s,e[4]=o):o=e[4];let l;return e[5]!==r||e[6]!==o?(l=t.jsx("div",{"data-slot":"skeleton",className:o,...r}),e[5]=r,e[6]=o,e[7]=l):l=e[7],l}const F=a=>{const e=j.c(2),{count:s}=a,r=s===void 0?20:s;let o;return e[0]!==r?(o=t.jsx(t.Fragment,{children:Array.from({length:r}).map(R)}),e[0]=r,e[1]=o):o=e[1],o};function R(a,e){return t.jsx("div",{className:"aspect-square",role:"status","aria-label":"Loading photo",children:t.jsx(H,{className:"h-full w-full rounded-lg"})},e)}const G=a=>{const e=j.c(13),{initialPhotos:s,initialCursor:r,initialHasMore:o}=a,[l,m]=x.useState(s),[c,u]=x.useState(r),[n,f]=x.useState(o),[i,p]=x.useState(!1),h=x.useRef(null),d=x.useRef(null);let v;e[0]!==c||e[1]!==n||e[2]!==i?(v=()=>{i||!n||!c||(p(!0),P.get("/gallery/list",{cursor:c},{preserveScroll:!0,preserveState:!0,only:["photos","next_cursor","has_more"],onSuccess:b=>{const g=b.props.photos||[],L=b.props.next_cursor||null,w=b.props.has_more||!1;m(S=>[...S,...g]),u(L),f(w)},onError:I,onFinish:()=>{p(!1)}}))},e[0]=c,e[1]=n,e[2]=i,e[3]=v):v=e[3];const N=v;let y,k;e[4]!==n||e[5]!==i||e[6]!==N?(y=()=>{const b={root:null,rootMargin:"100px",threshold:.1};d.current=new IntersectionObserver(L=>{L[0].isIntersecting&&!i&&n&&N()},b);const g=h.current;return g&&d.current&&d.current.observe(g),()=>{d.current&&g&&d.current.unobserve(g),d.current&&d.current.disconnect()}},k=[i,n,N],e[4]=n,e[5]=i,e[6]=N,e[7]=y,e[8]=k):(y=e[7],k=e[8]),x.useEffect(y,k);let _;return e[9]!==n||e[10]!==i||e[11]!==l?(_=t.jsx("div",{className:"w-full",children:l.length===0&&!i?t.jsx("div",{className:"flex min-h-[400px] items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("svg",{className:"mx-auto h-16 w-16 text-muted-foreground",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsx("h3",{className:"mt-4 text-lg font-medium text-foreground",children:"No photos available yet"}),t.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"No photos available yet. Check back soon!"})]})}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5",role:"list","aria-label":"Photo gallery",children:[l.map(B),i&&t.jsx(F,{count:20})]}),t.jsxs("div",{ref:h,className:"mt-8 flex justify-center","aria-live":"polite","aria-atomic":"true",children:[i&&t.jsx("p",{className:"text-sm text-muted-foreground","aria-label":"Loading more photos",children:"Loading more photos..."}),!n&&l.length>0&&t.jsx("p",{className:"text-sm text-muted-foreground",children:"You've reached the end!"})]})]})}),e[9]=n,e[10]=i,e[11]=l,e[12]=_):_=e[12],_};function I(a){console.error("Failed to load more photos:",a)}function B(a){return t.jsx(E,{photo:a,votingUrl:`/gallery/${a.id}`},a.id)}function U(a){const e=j.c(9),{photos:s,next_cursor:r,has_more:o}=a;let l;e[0]===Symbol.for("react.memo_cache_sentinel")?(l=t.jsx($,{title:"Photo Gallery",children:t.jsx("meta",{name:"description",content:"Browse and vote on photos from our photo contest"})}),e[0]=l):l=e[0];let m;e[1]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx("header",{className:"border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:t.jsxs("div",{className:"container mx-auto px-4 py-6 sm:px-6 lg:px-8",children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight text-foreground sm:text-4xl",children:"Photo Gallery"}),t.jsx("p",{className:"mt-2 text-sm text-muted-foreground sm:text-base",children:"Browse and vote on your favorite photos"})]})}),e[1]=m):m=e[1];let c;e[2]!==o||e[3]!==r||e[4]!==s?(c=t.jsx("main",{className:"container mx-auto px-4 py-8 sm:px-6 lg:px-8",children:t.jsx(G,{initialPhotos:s,initialCursor:r,initialHasMore:o})}),e[2]=o,e[3]=r,e[4]=s,e[5]=c):c=e[5];let u;e[6]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx("footer",{className:"mt-16 border-t",children:t.jsx("div",{className:"container mx-auto px-4 py-6 text-center text-sm text-muted-foreground sm:px-6 lg:px-8",children:t.jsx("p",{children:"Photo Contest Gallery"})})}),e[6]=u):u=e[6];let n;return e[7]!==c?(n=t.jsxs(t.Fragment,{children:[l,t.jsxs("div",{className:"min-h-screen bg-background",children:[m,c,u]})]}),e[7]=c,e[8]=n):n=e[8],n}export{U as default};
