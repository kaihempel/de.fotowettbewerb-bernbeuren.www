import{c as P,j as t,a as A,r as $,H as Q}from"./app-vjamzGlt.js";import{c as O,I as F,g as M,u as q,t as W,b as U,k as X,n as Y}from"./public-header-C6hcvf9O.js";import{C as ee,a as te}from"./chevron-right-B2ZmlX9I.js";import{G as le}from"./global-layout-B5AyPaZU.js";/* empty css            *//**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ae=O("star",se);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],oe=O("thumbs-up",re);function ie(f){const e=P.c(7),{previousPhoto:l,nextPhoto:r}=f,o=ne;let a;e[0]!==l?(a=l&&t.jsx(F,{variant:"secondary",onClick:()=>o(l.id),className:M("fixed left-4 top-1/2 z-10 size-12 -translate-y-1/2 rounded-full bg-background/80 shadow-lg backdrop-blur-sm transition-all hover:scale-110 hover:bg-background/90 dark:bg-background/90 dark:hover:bg-background md:left-6 md:size-14"),"aria-label":"Previous photo",children:t.jsx(ee,{className:"size-6 md:size-7"})}),e[0]=l,e[1]=a):a=e[1];let s;e[2]!==r?(s=r&&t.jsx(F,{variant:"secondary",onClick:()=>o(r.id),className:M("fixed right-4 top-1/2 z-10 size-12 -translate-y-1/2 rounded-full bg-background/80 shadow-lg backdrop-blur-sm transition-all hover:scale-110 hover:bg-background/90 dark:bg-background/90 dark:hover:bg-background md:right-6 md:size-14"),"aria-label":"Next photo",children:t.jsx(te,{className:"size-6 md:size-7"})}),e[2]=r,e[3]=s):s=e[3];let i;return e[4]!==a||e[5]!==s?(i=t.jsxs(t.Fragment,{children:[a,s]}),e[4]=a,e[5]=s,e[6]=i):i=e[6],i}function ne(f){A.visit(`/gallery/${f}`,{preserveScroll:!1})}function ce(f){const e=P.c(26),{imageUrl:l,title:r,rate:o}=f,{t:a}=q("gallery");let s;e[0]!==a||e[1]!==r?(s=r||a("viewer.contestPhoto"),e[0]=a,e[1]=r,e[2]=s):s=e[2];let i;e[3]!==l||e[4]!==s?(i=t.jsx("div",{className:"relative w-full overflow-hidden rounded-lg bg-muted shadow-xl",children:t.jsx("img",{src:l,alt:s,className:"h-auto w-full max-h-[calc(100vh-20rem)] object-contain md:max-h-[calc(100vh-13rem)]",loading:"eager"})}),e[3]=l,e[4]=s,e[5]=i):i=e[5];let p;e[6]!==r?(p=r&&t.jsx("h2",{className:"text-lg font-semibold text-foreground md:text-xl",children:r}),e[6]=r,e[7]=p):p=e[7];const h=o>0?"fill-yellow-400 text-yellow-400 dark:fill-yellow-500 dark:text-yellow-500":"text-muted-foreground";let u;e[8]!==h?(u=M("size-5",h),e[8]=h,e[9]=u):u=e[9];let n;e[10]!==u?(n=t.jsx(ae,{className:u}),e[10]=u,e[11]=n):n=e[11];let g;e[12]!==o||e[13]!==a?(g=a("viewer.rating",{rate:o}),e[12]=o,e[13]=a,e[14]=g):g=e[14];let d;e[15]!==g?(d=t.jsx("span",{className:"text-sm font-medium text-foreground",children:g}),e[15]=g,e[16]=d):d=e[16];let m;e[17]!==n||e[18]!==d?(m=t.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-muted px-4 py-2",children:[n,d]}),e[17]=n,e[18]=d,e[19]=m):m=e[19];let c;e[20]!==p||e[21]!==m?(c=t.jsxs("div",{className:"flex w-full flex-col items-center gap-2 text-center",children:[p,m]}),e[20]=p,e[21]=m,e[22]=c):c=e[22];let x;return e[23]!==c||e[24]!==i?(x=t.jsxs("div",{className:"flex w-full max-w-6xl flex-col items-center gap-4",children:[i,c]}),e[23]=c,e[24]=i,e[25]=x):x=e[25],x}function de(f){const e=P.c(23),{currentVote:l,onVote:r,isSubmitting:o}=f,{t:a}=q("gallery"),s=l==="up"?"primary":"secondary";let i;e[0]!==r?(i=()=>r("up"),e[0]=r,e[1]=i):i=e[1];const p=l==="up"&&"bg-green-600 text-white hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800",h=l!=="up"&&"border-2 hover:border-green-600 hover:bg-green-50 dark:hover:border-green-700 dark:hover:bg-green-950/30";let u;e[2]!==p||e[3]!==h?(u=M("min-h-[44px] min-w-[44px] gap-3 px-6 py-3 text-base transition-all md:min-h-[48px] md:min-w-[48px] md:px-8 md:py-4 md:text-lg",p,h),e[2]=p,e[3]=h,e[4]=u):u=e[4];let n;e[5]!==a?(n=a("voting.thumbsUp"),e[5]=a,e[6]=n):n=e[6];const g=l==="up";let d;e[7]!==l||e[8]!==o?(d=o&&l==="up"?t.jsx(W,{className:"size-5 md:size-6"}):t.jsx(oe,{className:M("size-5 md:size-6",l==="up"&&"fill-current")}),e[7]=l,e[8]=o,e[9]=d):d=e[9];let m;e[10]!==a?(m=a("voting.thumbsUp"),e[10]=a,e[11]=m):m=e[11];let c;e[12]!==m?(c=t.jsx("span",{className:"font-semibold",children:m}),e[12]=m,e[13]=c):c=e[13];let x;return e[14]!==o||e[15]!==s||e[16]!==c||e[17]!==i||e[18]!==u||e[19]!==n||e[20]!==g||e[21]!==d?(x=t.jsx("div",{className:"flex items-center justify-center gap-4 md:gap-6",children:t.jsxs(F,{variant:s,onClick:i,disabled:o,className:u,"aria-label":n,"aria-pressed":g,children:[d,c]})}),e[14]=o,e[15]=s,e[16]=c,e[17]=i,e[18]=u,e[19]=n,e[20]=g,e[21]=d,e[22]=x):x=e[22],x}function me(f){const e=P.c(52),{photo:l,nextPhoto:r,previousPhoto:o,progress:a}=f,{t:s}=q("gallery"),[i,p]=$.useState(null),[h,u]=$.useState(!1),[n,g]=$.useState(null),[d,m]=$.useState(0),c=i!==null?i:l.user_vote;let x,I;e[0]!==r||e[1]!==o?(x=()=>{const V=E=>{E.target instanceof HTMLInputElement||E.target instanceof HTMLTextAreaElement||(E.key==="ArrowLeft"&&o?A.visit(`/gallery/${o.id}`,{preserveScroll:!1}):E.key==="ArrowRight"&&r&&A.visit(`/gallery/${r.id}`,{preserveScroll:!1}))};return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},I=[r,o],e[0]=r,e[1]=o,e[2]=x,e[3]=I):(x=e[2],I=e[3]),$.useEffect(x,I);let R;e[4]!==c||e[5]!==l.id||e[6]!==s?(R=V=>{if(c===V)return;const E=c;p(V),u(!0),g(null);const B=K=>{const T=K===void 0?0:K;A.post(`/gallery/${l.id}/vote`,{vote_type:V},{preserveScroll:!0,onError:Z=>{if(T<3){const J=Math.pow(2,T)*500;setTimeout(()=>{B(T+1)},J),m(T+1)}else p(E),g(Z.vote_type||s("errors.submitFailed")),m(0)},onSuccess:()=>{m(0),g(null)},onFinish:()=>{u(!1)}})};B()},e[4]=c,e[5]=l.id,e[6]=s,e[7]=R):R=e[7];const G=R,D=a.rated===a.total;let b;e[8]!==s?(b=s("pageTitle"),e[8]=s,e[9]=b):b=e[9];let v;e[10]!==b?(v=t.jsx(Q,{title:b}),e[10]=b,e[11]=v):v=e[11];let j;e[12]!==n?(j=n&&t.jsx("div",{className:"fixed left-1/2 top-4 z-10 w-full max-w-md -translate-x-1/2",children:t.jsxs(U,{type:"default",children:[t.jsx(U.Icon,{path:X,iconClass:"text-orange-400",iconDivClass:"bg-orange-500/20"}),t.jsx("span",{children:n})]})}),e[12]=n,e[13]=j):j=e[13];let k;e[14]!==d||e[15]!==s?(k=d>0&&t.jsx("div",{className:"fixed left-1/2 top-4 z-10 -translate-x-1/2",children:t.jsx("div",{className:"rounded-lg bg-yellow-100 px-4 py-2 text-sm text-yellow-900 dark:bg-yellow-900/20 dark:text-yellow-100",children:s("voting.retrying",{count:d})})}),e[14]=d,e[15]=s,e[16]=k):k=e[16];let y;e[17]!==n||e[18]!==D||e[19]!==a.total||e[20]!==s?(y=D&&!n&&t.jsx("div",{className:"fixed left-1/2 top-4 z-10 w-full max-w-md -translate-x-1/2",children:t.jsxs(U,{type:"default",children:[t.jsx(U.Icon,{path:Y,iconClass:"text-orange-400",iconDivClass:"bg-orange-500/20"}),t.jsx("span",{children:s("progress.completed",{total:a.total})})]})}),e[17]=n,e[18]=D,e[19]=a.total,e[20]=s,e[21]=y):y=e[21];let w;e[22]!==a.rated||e[23]!==a.total||e[24]!==s?(w=s("progress.rated",{rated:a.rated,total:a.total}),e[22]=a.rated,e[23]=a.total,e[24]=s,e[25]=w):w=e[25];let N;e[26]!==w?(N=t.jsx("div",{className:"rounded-lg bg-background/80 px-4 py-2 shadow-lg backdrop-blur-sm dark:bg-background/90",children:t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:w})}),e[26]=w,e[27]=N):N=e[27];let z;e[28]!==l.full_image_url||e[29]!==l.rate||e[30]!==l.title?(z=t.jsx(ce,{imageUrl:l.full_image_url,title:l.title,rate:l.rate}),e[28]=l.full_image_url,e[29]=l.rate,e[30]=l.title,e[31]=z):z=e[31];let C;e[32]!==N||e[33]!==z?(C=t.jsxs("div",{className:"flex flex-1 flex-col items-center gap-6 p-4 pt-8 md:p-6 md:pt-12",children:[N,z]}),e[32]=N,e[33]=z,e[34]=C):C=e[34];let _;e[35]!==c||e[36]!==G||e[37]!==h?(_=t.jsx("div",{className:"fixed bottom-7 left-0 right-0 bg-background/80 p-4 backdrop-blur-sm dark:bg-background/90 md:p-6",children:t.jsx("div",{className:"mx-auto max-w-2xl",children:t.jsx(de,{currentVote:c,onVote:G,isSubmitting:h})})}),e[35]=c,e[36]=G,e[37]=h,e[38]=_):_=e[38];let S;e[39]!==r||e[40]!==o?(S=t.jsx(ie,{previousPhoto:o,nextPhoto:r}),e[39]=r,e[40]=o,e[41]=S):S=e[41];let L;e[42]!==C||e[43]!==_||e[44]!==S||e[45]!==j||e[46]!==k||e[47]!==y?(L=t.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[j,k,y,C,_,S]}),e[42]=C,e[43]=_,e[44]=S,e[45]=j,e[46]=k,e[47]=y,e[48]=L):L=e[48];let H;return e[49]!==L||e[50]!==v?(H=t.jsxs(le,{className:"p-0",children:[v,L]}),e[49]=L,e[50]=v,e[51]=H):H=e[51],H}function he(f){const e=P.c(2);let l;return e[0]!==f?(l=t.jsx(me,{...f},f.photo.id),e[0]=f,e[1]=l):l=e[1],l}export{he as default};
