import{c as S,j as t,a as I,r as _,H as q}from"./app-Bmu__Epa.js";import{I as H,e as C,t as B,b as R,j as K,k as O,G as Z}from"./global-layout-CX9jzFOa.js";import{C as J,a as Q}from"./chevron-right-CEKVrogl.js";import{c as D}from"./createLucideIcon-CR6s348F.js";/* empty css            *//**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],X=D("star",W);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],te=D("thumbs-up",ee);function le(f){const e=S.c(7),{previousPhoto:l,nextPhoto:a}=f,r=se;let s;e[0]!==l?(s=l&&t.jsx(H,{variant:"secondary",onClick:()=>r(l.id),className:C("fixed left-4 top-1/2 z-10 size-12 -translate-y-1/2 rounded-full bg-background/80 shadow-lg backdrop-blur-sm transition-all hover:scale-110 hover:bg-background/90 dark:bg-background/90 dark:hover:bg-background md:left-6 md:size-14"),"aria-label":"Previous photo",children:t.jsx(J,{className:"size-6 md:size-7"})}),e[0]=l,e[1]=s):s=e[1];let o;e[2]!==a?(o=a&&t.jsx(H,{variant:"secondary",onClick:()=>r(a.id),className:C("fixed right-4 top-1/2 z-10 size-12 -translate-y-1/2 rounded-full bg-background/80 shadow-lg backdrop-blur-sm transition-all hover:scale-110 hover:bg-background/90 dark:bg-background/90 dark:hover:bg-background md:right-6 md:size-14"),"aria-label":"Next photo",children:t.jsx(Q,{className:"size-6 md:size-7"})}),e[2]=a,e[3]=o):o=e[3];let i;return e[4]!==s||e[5]!==o?(i=t.jsxs(t.Fragment,{children:[s,o]}),e[4]=s,e[5]=o,e[6]=i):i=e[6],i}function se(f){I.visit(`/gallery/${f}`,{preserveScroll:!1})}function ae(f){const e=S.c(20),{imageUrl:l,title:a,rate:r}=f,s=a||"Contest photo";let o;e[0]!==l||e[1]!==s?(o=t.jsx("div",{className:"relative w-full overflow-hidden rounded-lg bg-muted shadow-xl",children:t.jsx("img",{src:l,alt:s,className:"h-auto w-full max-h-[calc(100vh-20rem)] object-contain md:max-h-[calc(100vh-13rem)]",loading:"eager"})}),e[0]=l,e[1]=s,e[2]=o):o=e[2];let i;e[3]!==a?(i=a&&t.jsx("h2",{className:"text-lg font-semibold text-foreground md:text-xl",children:a}),e[3]=a,e[4]=i):i=e[4];const g=r>0?"fill-yellow-400 text-yellow-400 dark:fill-yellow-500 dark:text-yellow-500":"text-muted-foreground";let d;e[5]!==g?(d=C("size-5",g),e[5]=g,e[6]=d):d=e[6];let n;e[7]!==d?(n=t.jsx(X,{className:d}),e[7]=d,e[8]=n):n=e[8];let c;e[9]!==r?(c=t.jsxs("span",{className:"text-sm font-medium text-foreground",children:["Rating: ",r]}),e[9]=r,e[10]=c):c=e[10];let m;e[11]!==n||e[12]!==c?(m=t.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-muted px-4 py-2",children:[n,c]}),e[11]=n,e[12]=c,e[13]=m):m=e[13];let u;e[14]!==i||e[15]!==m?(u=t.jsxs("div",{className:"flex w-full flex-col items-center gap-2 text-center",children:[i,m]}),e[14]=i,e[15]=m,e[16]=u):u=e[16];let x;return e[17]!==o||e[18]!==u?(x=t.jsxs("div",{className:"flex w-full max-w-6xl flex-col items-center gap-4",children:[o,u]}),e[17]=o,e[18]=u,e[19]=x):x=e[19],x}function re(f){const e=S.c(16),{currentVote:l,onVote:a,isSubmitting:r}=f,s=l==="up"?"primary":"secondary";let o;e[0]!==a?(o=()=>a("up"),e[0]=a,e[1]=o):o=e[1];const i=l==="up"&&"bg-green-600 text-white hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800",g=l!=="up"&&"border-2 hover:border-green-600 hover:bg-green-50 dark:hover:border-green-700 dark:hover:bg-green-950/30";let d;e[2]!==i||e[3]!==g?(d=C("min-h-[44px] min-w-[44px] gap-3 px-6 py-3 text-base transition-all md:min-h-[48px] md:min-w-[48px] md:px-8 md:py-4 md:text-lg",i,g),e[2]=i,e[3]=g,e[4]=d):d=e[4];const n=l==="up";let c;e[5]!==l||e[6]!==r?(c=r&&l==="up"?t.jsx(B,{className:"size-5 md:size-6"}):t.jsx(te,{className:C("size-5 md:size-6",l==="up"&&"fill-current")}),e[5]=l,e[6]=r,e[7]=c):c=e[7];let m;e[8]===Symbol.for("react.memo_cache_sentinel")?(m=t.jsx("span",{className:"font-semibold",children:"Thumbs Up"}),e[8]=m):m=e[8];let u;return e[9]!==r||e[10]!==s||e[11]!==o||e[12]!==d||e[13]!==n||e[14]!==c?(u=t.jsx("div",{className:"flex items-center justify-center gap-4 md:gap-6",children:t.jsxs(H,{variant:s,onClick:o,disabled:r,className:d,"aria-label":"Vote thumbs up","aria-pressed":n,children:[c,m]})}),e[9]=r,e[10]=s,e[11]=o,e[12]=d,e[13]=n,e[14]=c,e[15]=u):u=e[15],u}function oe(f){const e=S.c(40),{photo:l,nextPhoto:a,previousPhoto:r,progress:s}=f,[o,i]=_.useState(null),[g,d]=_.useState(!1),[n,c]=_.useState(null),[m,u]=_.useState(0),x=o!==null?o:l.user_vote;let V,L;e[0]!==a||e[1]!==r?(V=()=>{const N=z=>{z.target instanceof HTMLInputElement||z.target instanceof HTMLTextAreaElement||(z.key==="ArrowLeft"&&r?I.visit(`/gallery/${r.id}`,{preserveScroll:!1}):z.key==="ArrowRight"&&a&&I.visit(`/gallery/${a.id}`,{preserveScroll:!1}))};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},L=[a,r],e[0]=a,e[1]=r,e[2]=V,e[3]=L):(V=e[2],L=e[3]),_.useEffect(V,L);let E;e[4]!==x||e[5]!==l.id?(E=N=>{if(x===N)return;const z=x;i(N),d(!0),c(null);const T=U=>{const M=U===void 0?0:U;I.post(`/gallery/${l.id}/vote`,{vote_type:N},{preserveScroll:!0,onError:F=>{if(M<3){const Y=Math.pow(2,M)*500;setTimeout(()=>{T(M+1)},Y),u(M+1)}else i(z),c(F.vote_type||"Failed to submit vote after multiple attempts. Please try again."),u(0)},onSuccess:()=>{u(0),c(null)},onFinish:()=>{d(!1)}})};T()},e[4]=x,e[5]=l.id,e[6]=E):E=e[6];const A=E,G=s.rated===s.total;let $;e[7]===Symbol.for("react.memo_cache_sentinel")?($=t.jsx(q,{title:"Photo Voting Gallery"}),e[7]=$):$=e[7];let h;e[8]!==n?(h=n&&t.jsx("div",{className:"fixed left-1/2 top-4 z-10 w-full max-w-md -translate-x-1/2",children:t.jsxs(R,{type:"default",children:[t.jsx(R.Icon,{path:K,iconClass:"text-orange-400",iconDivClass:"bg-orange-500/20"}),t.jsx("span",{children:n})]})}),e[8]=n,e[9]=h):h=e[9];let p;e[10]!==m?(p=m>0&&t.jsx("div",{className:"fixed left-1/2 top-4 z-10 -translate-x-1/2",children:t.jsxs("div",{className:"rounded-lg bg-yellow-100 px-4 py-2 text-sm text-yellow-900 dark:bg-yellow-900/20 dark:text-yellow-100",children:["Retrying... (Attempt ",m,"/3)"]})}),e[10]=m,e[11]=p):p=e[11];let b;e[12]!==n||e[13]!==G||e[14]!==s.total?(b=G&&!n&&t.jsx("div",{className:"fixed left-1/2 top-4 z-10 w-full max-w-md -translate-x-1/2",children:t.jsxs(R,{type:"default",children:[t.jsx(R.Icon,{path:O,iconClass:"text-orange-400",iconDivClass:"bg-orange-500/20"}),t.jsxs("span",{children:["You have rated all ",s.total," photos. You can still navigate and change your votes."]})]})}),e[12]=n,e[13]=G,e[14]=s.total,e[15]=b):b=e[15];let v;e[16]!==s.rated||e[17]!==s.total?(v=t.jsx("div",{className:"rounded-lg bg-background/80 px-4 py-2 shadow-lg backdrop-blur-sm dark:bg-background/90",children:t.jsxs("p",{className:"text-sm font-medium text-muted-foreground",children:[s.rated," of ",s.total," photos rated"]})}),e[16]=s.rated,e[17]=s.total,e[18]=v):v=e[18];let y;e[19]!==l.full_image_url||e[20]!==l.rate||e[21]!==l.title?(y=t.jsx(ae,{imageUrl:l.full_image_url,title:l.title,rate:l.rate}),e[19]=l.full_image_url,e[20]=l.rate,e[21]=l.title,e[22]=y):y=e[22];let j;e[23]!==v||e[24]!==y?(j=t.jsxs("div",{className:"flex flex-1 flex-col items-center gap-6 p-4 pt-8 md:p-6 md:pt-12",children:[v,y]}),e[23]=v,e[24]=y,e[25]=j):j=e[25];let k;e[26]!==x||e[27]!==A||e[28]!==g?(k=t.jsx("div",{className:"fixed bottom-7 left-0 right-0 bg-background/80 p-4 backdrop-blur-sm dark:bg-background/90 md:p-6",children:t.jsx("div",{className:"mx-auto max-w-2xl",children:t.jsx(re,{currentVote:x,onVote:A,isSubmitting:g})})}),e[26]=x,e[27]=A,e[28]=g,e[29]=k):k=e[29];let w;e[30]!==a||e[31]!==r?(w=t.jsx(le,{previousPhoto:r,nextPhoto:a}),e[30]=a,e[31]=r,e[32]=w):w=e[32];let P;return e[33]!==j||e[34]!==k||e[35]!==w||e[36]!==h||e[37]!==p||e[38]!==b?(P=t.jsxs(Z,{className:"p-0",children:[$,t.jsxs("div",{className:"flex min-h-screen flex-col bg-background",children:[h,p,b,j,k,w]})]}),e[33]=j,e[34]=k,e[35]=w,e[36]=h,e[37]=p,e[38]=b,e[39]=P):P=e[39],P}function ue(f){const e=S.c(2);let l;return e[0]!==f?(l=t.jsx(oe,{...f},f.photo.id),e[0]=f,e[1]=l):l=e[1],l}export{ue as default};
